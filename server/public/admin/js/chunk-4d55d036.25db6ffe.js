(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d55d036"],{"32f6":function(t,e,a){"use strict";(function(t){a("7f7f"),a("ac6a"),a("a481"),a("cadf"),a("551c"),a("097d");var i=a("1a0b"),s=a.n(i);e["a"]={data:function(){return{is_show_preview:!1,mode:"set",add_data:{},type_list:[{id:1,title:"法律头条"},{id:2,title:"经典案例"}],preview_data:"",predefineColors:["#ff4500","#ff8c00","#ffd700","#90ee90","#00ced1","#1e90ff","#c71585"],content_arr:[],content_index:-1}},mounted:function(){this.initEditor()},activated:function(){this.editor||this.initEditor(),"add"==this.$route.params.id?(this.mode="add",this.add_data={type:1,title:"",tag:"",tag_color:"#1E90FF",views:0,is_show:0,title_picture:0}):(this.edit_id=this.$route.params.id,this.getContent())},methods:{initEditor:function(){this.editor=new s.a(this.$refs.editor),this.editor.customConfig.uploadImgServer="http://116.62.208.170/index.php/api/admin/articles/editor_pic",this.editor.customConfig.uploadImgParams={appid:localStorage.getItem("token")},this.editor.customConfig.uploadFileName="file",this.editor.customConfig.uploadImgMaxLength=1,this.editor.customConfig.zIndex=100,this.editor.customConfig.onchange=function(t){localStorage.setItem("editor_backup",t)},this.editor.create(),this.editor.txt.html(localStorage.getItem("editor_backup")||"")},getContent:function(){var t=this;this.requestApi({url:"articles/get",data:{id:this.edit_id},success:function(e){t.add_data=e,t.editor.txt.html(e.content)}})},upPicSuccess:function(t){1==t.status?this.add_data.title_picture=t.data:this.$message.error("服务器错误")},submit:function(e){var a=this;if(this.add_data.content=this.editor.txt.html().replace(/<font[^>]*>/g,""),this.add_data.content=this.add_data.content.replace(/<\/font>/g,""),this.add_data.content=encodeURIComponent(this.add_data.content.replace(/font-size:.*?;/g,"")),""==this.add_data.title)return this.$message.warning("请输入标题"),0;this.add_data.is_show=e,this.requestApi({url:"articles/"+this.mode,data:this.add_data,success:function(i){0==e?(a.mode="set",a.edit_id=i,a.editor.txt.html(a.add_data.content)):"add"==a.mode&&a.$router.go(-1),a.$message.success("操作成功！"),t.edited=!0}})},formatText:function(t,e){var a=this;t&&t.forEach(function(t){if("string"==typeof t&&"p"==a.content_arr[e].name)a.content_arr[e].children[0].text+=t;else{if("img"==t.tag){var i="";return t.attrs.forEach(function(t){"src"==t.name&&(i=t.value)}),a.content_arr[e]={name:"img",attrs:{style:"display: block;width: 100%;",src:i}},!1}t.children&&a.formatText(t.children,e)}})},getChildrenText:function(t){},showPreview:function(){this.preview_data=this.editor.txt.html(),this.is_show_preview=!0},goBack:function(){this.title="",this.editor.txt.html(""),this.$router.go(-1)}}}}).call(this,a("c8ba"))},"695c":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"search_bar"},[a("el-button",{attrs:{type:"default",icon:"el-icon-arrow-left"},on:{click:function(e){t.goBack()}}},[t._v("返回")]),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.showPreview()}}},[t._v("预览")]),a("el-button",{attrs:{type:"info"},on:{click:function(e){t.submit(0)}}},[t._v(t._s(1==t.add_data.is_show?"撤销发布":"保存草稿"))]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submit(1)}}},[t._v(t._s("set"==t.mode?"确认修改并发布":"确认发布"))]),a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("学法文章编辑")])],1)],1),a("el-form",{staticStyle:{background:"#fff",padding:"20px"},attrs:{"label-width":"90px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"类别"}},[a("el-select",{attrs:{placeholder:"请选择"},model:{value:t.add_data.type,callback:function(e){t.$set(t.add_data,"type",e)},expression:"add_data.type"}},t._l(t.type_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"标题"}},[a("el-input",{model:{value:t.add_data.title,callback:function(e){t.$set(t.add_data,"title",e)},expression:"add_data.title"}})],1),a("el-form-item",{staticStyle:{width:"340px"},attrs:{label:"标签"}},[a("el-input",{staticStyle:{width:"200px"},model:{value:t.add_data.tag,callback:function(e){t.$set(t.add_data,"tag",e)},expression:"add_data.tag"}}),a("el-color-picker",{staticStyle:{float:"right"},attrs:{predefine:t.predefineColors},model:{value:t.add_data.tag_color,callback:function(e){t.$set(t.add_data,"tag_color",e)},expression:"add_data.tag_color"}})],1),a("el-form-item",{attrs:{label:"内容简介"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.add_data.abstract,callback:function(e){t.$set(t.add_data,"abstract",e)},expression:"add_data.abstract"}})],1),a("el-form-item",{attrs:{label:"默认浏览量"}},[a("el-input",{model:{value:t.add_data.views,callback:function(e){t.$set(t.add_data,"views",e)},expression:"add_data.views"}})],1),a("el-form-item",{attrs:{label:"标题图片"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.ServerUrl+"articles/upload","show-file-list":!1,"on-success":t.upPicSuccess}},[t.add_data.title_picture?a("img",{staticClass:"upload-picture",attrs:{src:t.ImgUrl+t.add_data.title_picture}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("div",{ref:"editor"})],1),a("el-dialog",{attrs:{title:"预览",visible:t.is_show_preview,width:"410px"},on:{"update:visible":function(e){t.is_show_preview=e}}},[a("div",{staticClass:"preview_title"},[t._v("iPhone6屏幕尺寸")]),a("div",{staticClass:"preview_box",domProps:{innerHTML:t._s(t.preview_data)}})])],1)},s=[],o=a("32f6"),r=o["a"],d=a("2877"),n=Object(d["a"])(r,i,s,!1,null,null,null);n.options.__file="articles_edit.vue";e["default"]=n.exports},"7f7f":function(t,e,a){var i=a("86cc").f,s=Function.prototype,o=/^\s*function ([^ (]*)/,r="name";r in s||a("9e1e")&&i(s,r,{configurable:!0,get:function(){try{return(""+this).match(o)[1]}catch(t){return""}}})},ac6a:function(t,e,a){for(var i=a("cadf"),s=a("0d58"),o=a("2aba"),r=a("7726"),d=a("32e9"),n=a("84f2"),l=a("2b4c"),c=l("iterator"),u=l("toStringTag"),f=n.Array,p={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},h=s(p),_=0;_<h.length;_++){var m,g=h[_],v=p[g],b=r[g],w=b&&b.prototype;if(w&&(w[c]||d(w,c,f),w[u]||d(w,u,g),n[g]=f,v))for(m in i)w[m]||o(w,m,i[m],!0)}}}]);