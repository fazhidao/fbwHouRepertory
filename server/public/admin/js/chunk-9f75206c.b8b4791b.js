(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-9f75206c"],{6135:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"container"},[i("div",{staticClass:"search_bar"},[0!=t.agency_id?i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{icon:"el-icon-arrow-left",type:"default"},on:{click:function(e){t.$router.go(-1)}}},[t._v("返回")]):t._e(),i("el-input",{staticClass:"main_input",attrs:{placeholder:"输入名称或手机号搜索",clearable:""},model:{value:t.main_input.text,callback:function(e){t.$set(t.main_input,"text",e)},expression:"main_input.text"}}),i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",clearable:"",placeholder:"省"},on:{change:t.changeProvince},model:{value:t.main_input.province_id,callback:function(e){t.$set(t.main_input,"province_id",e)},expression:"main_input.province_id"}},t._l(t.province_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",clearable:"",placeholder:"市"},on:{change:t.changeCity},model:{value:t.main_input.city_id,callback:function(e){t.$set(t.main_input,"city_id",e)},expression:"main_input.city_id"}},t._l(t.city_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",clearable:"",placeholder:"区"},model:{value:t.main_input.district_id,callback:function(e){t.$set(t.main_input,"district_id",e)},expression:"main_input.district_id"}},t._l(t.district_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){t.getTableData()}}},[t._v("搜 索")]),0==t.agency_id?i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.is_show_add=!0}}},[t._v("新增客户")]):t._e(),i("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[i("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[t._v("首页")]),0!=t.agency_id?i("el-breadcrumb-item",[t._v("用户数据管理")]):t._e(),0!=t.agency_id?i("el-breadcrumb-item",{attrs:{to:{path:"/userdocs_agencies"}}},[t._v("代理商管理")]):t._e(),0!=t.agency_id?i("el-breadcrumb-item",[t._v("代理商客户列表")]):t._e(),0==t.agency_id?i("el-breadcrumb-item",[t._v("客户列表")]):t._e()],1)],1),i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.is_loading,expression:"is_loading"}],staticStyle:{width:"100%"},attrs:{height:t.table_height,data:t.table_data,border:""}},[i("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),i("el-table-column",{attrs:{label:"审核进度",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?i("el-tag",{attrs:{type:"info"}},[t._v("待审核")]):t._e(),1==e.row.status?i("el-tag",{attrs:{type:"warning"}},[t._v("审核失败")]):t._e(),2==e.row.status?i("el-tag",{attrs:{type:"success"}},[t._v("审核通过")]):t._e()]}}])}),i("el-table-column",{attrs:{label:"客户类型",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.user_class?i("div",[t._v("个人")]):t._e(),2==e.row.user_class?i("div",[t._v("企业")]):t._e()]}}])}),i("el-table-column",{attrs:{prop:"name",label:"名称"}}),i("el-table-column",{attrs:{prop:"phone",label:"手机"}}),i("el-table-column",{attrs:{prop:"vip_name",label:"vip等级"}}),i("el-table-column",{attrs:{label:"消费总额"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v("￥"+t._s(e.row.total_consume/100))])]}}])}),i("el-table-column",{attrs:{prop:"create_time",label:"创建时间",width:"140"}}),i("el-table-column",{attrs:{prop:"note",label:"备注"}}),i("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==t.agency_id?i("el-button",{attrs:{type:"text"},on:{click:function(i){t.showEditForm(e.row)}}},[t._v("编辑")]):t._e(),0==t.agency_id?i("el-button",{attrs:{type:"text"},on:{click:function(i){t.submitDel(e.row)}}},[t._v("删除")]):t._e(),i("el-button",{attrs:{type:"text"},on:{click:function(i){t.getOrders(e.row.id)}}},[t._v("查看消费记录")])]}}])})],1),i("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":t.page.current_page,"page-sizes":[50],"page-size":t.page.size,layout:"total,sizes, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.handleCurrentChange}}),i("el-dialog",{attrs:{title:"新增",visible:t.is_show_add,width:"600px"},on:{"update:visible":function(e){t.is_show_add=e}}},[i("el-form",{attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"用户类别"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.add_data.user_class,callback:function(e){t.$set(t.add_data,"user_class",e)},expression:"add_data.user_class"}},t._l(t.class_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),i("el-form-item",{attrs:{label:"名称"}},[i("el-input",{model:{value:t.add_data.name,callback:function(e){t.$set(t.add_data,"name",e)},expression:"add_data.name"}})],1),i("el-form-item",{attrs:{label:"手机"}},[i("el-input",{model:{value:t.add_data.phone,callback:function(e){t.$set(t.add_data,"phone",e)},expression:"add_data.phone"}})],1),i("el-form-item",{attrs:{label:"登录密码"}},[i("el-input",{model:{value:t.add_data.password,callback:function(e){t.$set(t.add_data,"password",e)},expression:"add_data.password"}})],1),i("el-form-item",{attrs:{label:"区域"}},[i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"省"},on:{change:t.changeProvince},model:{value:t.add_data.province_id,callback:function(e){t.$set(t.add_data,"province_id",e)},expression:"add_data.province_id"}},t._l(t.province_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"市"},on:{change:t.changeCity},model:{value:t.add_data.city_id,callback:function(e){t.$set(t.add_data,"city_id",e)},expression:"add_data.city_id"}},t._l(t.city_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"区"},model:{value:t.add_data.district_id,callback:function(e){t.$set(t.add_data,"district_id",e)},expression:"add_data.district_id"}},t._l(t.district_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),i("el-form-item",{attrs:{label:"具体地址"}},[i("el-input",{model:{value:t.add_data.address,callback:function(e){t.$set(t.add_data,"address",e)},expression:"add_data.address"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{model:{value:t.add_data.note,callback:function(e){t.$set(t.add_data,"note",e)},expression:"add_data.note"}})],1),i("el-form-item",{attrs:{label:"vip套餐"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.add_data.vip_id,callback:function(e){t.$set(t.add_data,"vip_id",e)},expression:"add_data.vip_id"}},t._l(t.vip_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.is_show_add=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitAdd()}}},[t._v("确 定")])],1)],1),i("el-dialog",{attrs:{title:"编辑",visible:t.is_show_edit,width:"600px"},on:{"update:visible":function(e){t.is_show_edit=e}}},[i("el-form",{attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[i("el-form-item",{attrs:{label:"用户类别"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.edit_data.user_class,callback:function(e){t.$set(t.edit_data,"user_class",e)},expression:"edit_data.user_class"}},t._l(t.class_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),i("el-form-item",{attrs:{label:"名称"}},[i("el-input",{model:{value:t.edit_data.name,callback:function(e){t.$set(t.edit_data,"name",e)},expression:"edit_data.name"}})],1),i("el-form-item",{attrs:{label:"手机"}},[i("el-input",{model:{value:t.edit_data.phone,callback:function(e){t.$set(t.edit_data,"phone",e)},expression:"edit_data.phone"}})],1),i("el-form-item",{attrs:{label:"区域"}},[i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"省"},on:{change:t.changeProvince},model:{value:t.edit_data.province_id,callback:function(e){t.$set(t.edit_data,"province_id",e)},expression:"edit_data.province_id"}},t._l(t.province_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"市"},on:{change:t.changeCity},model:{value:t.edit_data.city_id,callback:function(e){t.$set(t.edit_data,"city_id",e)},expression:"edit_data.city_id"}},t._l(t.city_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"区"},model:{value:t.edit_data.district_id,callback:function(e){t.$set(t.edit_data,"district_id",e)},expression:"edit_data.district_id"}},t._l(t.district_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),i("el-form-item",{attrs:{label:"具体地址"}},[i("el-input",{model:{value:t.edit_data.address,callback:function(e){t.$set(t.edit_data,"address",e)},expression:"edit_data.address"}})],1),i("el-form-item",{attrs:{label:"备注"}},[i("el-input",{model:{value:t.edit_data.note,callback:function(e){t.$set(t.edit_data,"note",e)},expression:"edit_data.note"}})],1),i("el-form-item",{attrs:{label:"vip套餐"}},[i("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"请选择"},model:{value:t.edit_data.vip_id,callback:function(e){t.$set(t.edit_data,"vip_id",e)},expression:"edit_data.vip_id"}},t._l(t.vip_list,function(t){return i("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1)],1),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.is_show_edit=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitEdit()}}},[t._v("重新提交审核")])],1)],1),i("el-dialog",{attrs:{title:"消费列表",visible:t.is_show_consume,width:"600px"},on:{"update:visible":function(e){t.is_show_consume=e}}},[i("el-table",{staticStyle:{width:"100%"},attrs:{data:t.order_list}},[i("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),i("el-table-column",{attrs:{label:"是否付款"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v(t._s(1==e.row.status?"已付款":"未付款"))])]}}])}),i("el-table-column",{attrs:{prop:"subject",label:"消费内容"}}),i("el-table-column",{attrs:{label:"消费金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v("￥"+t._s(e.row.pay_amount/100))])]}}])}),i("el-table-column",{attrs:{prop:"pay_time",label:"付款时间"}})],1)],1)],1)},l=[],n=(i("7f7f"),i("cadf"),i("551c"),i("097d"),{data:function(){return{is_loading:!1,is_show_add:!1,is_show_edit:!1,is_show_consume:!1,main_input:{text:"",province_id:"",city_id:"",district_id:""},add_data:{province_id:"",city_id:"",district_id:""},edit_data:{province_id:"",city_id:"",district_id:""},table_height:100,table_data:[],page:{current_page:1,size:50},province_list:[],city_list:[],district_list:[],vip_list:[],class_list:[{id:1,title:"个人"},{id:2,title:"企业"}],agency_id:0,order_list:[]}},created:function(){this.agency_id=this.$route.params.id,this.table_height=window.innerHeight-150,this.getTableData(),this.getAreaList(1),this.getVipList()},methods:{getVipList:function(){var t=this;this.requestApi({url:"vip_plans/get",success:function(e){t.vip_list=e}})},getTableData:function(){var t=this;this.is_loading=!0;var e={};""!=this.main_input.text&&(this.main_input.text>1?e.phone=this.main_input.text:e.name=this.main_input.text),""!=this.main_input.province_id&&(e.province_id=this.main_input.province_id),""!=this.main_input.city_id&&(e.city_id=this.main_input.city_id),""!=this.main_input.district_id&&(e.district_id=this.main_input.district_id),parseInt(this.agency_id)&&(e.agency_id=this.agency_id),this.requestApi({url:"clients/get",data:e,success:function(e){t.table_data=e.data,t.page.total=parseInt(e.total),t.is_loading=!1}})},getOrders:function(t){var e=this;this.requestApi({url:"orders/getList",data:{user_id:t},success:function(t){e.order_list=t,e.is_show_consume=!0}})},getAreaList:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a={area_level:t};i&&(a.parent_id=i),this.requestApi({url:"areainfos/get",data:a,success:function(i){1==t?e.province_list=i:2==t?e.city_list=i:e.district_list=i}})},submitDel:function(t){var e=this;this.$confirm("确定删除 "+t.name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.requestApi({url:"clients/del",data:{id:t.id},success:function(){e.$message.success("删除成功"),e.getTableData()}})}).catch(function(){})},submitAdd:function(){var t=this;this.requestApi({url:"clients/add",data:this.add_data,success:function(e){t.getTableData(),t.is_show_add=!1,t.$message.success("新增成功")}})},showEditForm:function(t){this.getAreaList(2,t.province_id),this.getAreaList(3,t.city_id),this.edit_data=JSON.parse(JSON.stringify(t)),this.is_show_edit=!0},submitEdit:function(){var t=this;this.requestApi({url:"clients/set",data:this.edit_data,success:function(e){t.getTableData(),t.is_show_edit=!1,t.$message.success("编辑成功")}})},changeProvince:function(t){this.add_data.city_id="",this.add_data.district_id="",this.getAreaList(2,t)},changeCity:function(t){this.add_data.district_id="",this.getAreaList(3,t)},handleCurrentChange:function(t){this.page.current_page=t,this.getTableData()}}}),s=n,d=i("2877"),r=Object(d["a"])(s,a,l,!1,null,null,null);r.options.__file="clients.vue";e["default"]=r.exports},"7f7f":function(t,e,i){var a=i("86cc").f,l=Function.prototype,n=/^\s*function ([^ (]*)/,s="name";s in l||i("9e1e")&&a(l,s,{configurable:!0,get:function(){try{return(""+this).match(n)[1]}catch(t){return""}}})}}]);