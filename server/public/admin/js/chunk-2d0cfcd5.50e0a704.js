(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0cfcd5"],{"64ef":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"search_bar"},[a("el-input",{staticClass:"main_input",attrs:{placeholder:"输入关键字检索",clearable:""},model:{value:t.main_input.keywords,callback:function(e){t.$set(t.main_input,"keywords",e)},expression:"main_input.keywords"}}),a("el-select",{staticStyle:{width:"120px","margin-right":"10px"},attrs:{placeholder:"类别",clearable:""},model:{value:t.main_input.type_id,callback:function(e){t.$set(t.main_input,"type_id",e)},expression:"main_input.type_id"}},t._l(t.type_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px","margin-right":"10px"},attrs:{placeholder:"行业",clearable:""},model:{value:t.main_input.industry_id,callback:function(e){t.$set(t.main_input,"industry_id",e)},expression:"main_input.industry_id"}},t._l(t.industry_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){t.getTableData()}}},[t._v("搜 索")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.is_show_add=!0}}},[t._v("新增合同")]),a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("合同管理")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.is_loading,expression:"is_loading"}],staticStyle:{width:"100%"},attrs:{height:t.table_height,data:t.table_data,border:""}},[a("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),a("el-table-column",{attrs:{prop:"type_name",label:"类别"}}),a("el-table-column",{attrs:{prop:"industry_name",label:"行业"}}),a("el-table-column",{attrs:{prop:"keywords",label:"关键字"},scopedSlots:t._u([{key:"default",fn:function(e){return t._l(e.row.keywords.split(" "),function(e){return a("el-tag",[t._v(t._s(e))])})}}])}),a("el-table-column",{attrs:{prop:"file_path",label:"文件路径"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{attrs:{href:t.ImgUrl+e.row.file_path,target:"_Blank"}},[t._v("点击下载原文件")])]}}])}),a("el-table-column",{attrs:{prop:"picture",label:"缩略图"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("img",{staticClass:"upload-picture pointer",attrs:{src:t.ImgUrl+e.row.picture},on:{click:function(a){t.showPic(e.row.picture)}}})]}}])}),a("el-table-column",{attrs:{prop:"price",label:"下载价格",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("￥"+t._s(e.row.price/100))])]}}])}),a("el-table-column",{attrs:{prop:"downloads",label:"已下载次数",width:"120"}}),a("el-table-column",{attrs:{label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showEditForm(e.row)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.submitDel(e.row)}}},[t._v("删除")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":t.page.current_page,"page-sizes":[50],"page-size":t.page.size,layout:"total,sizes, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:"新增",visible:t.is_show_add,width:"600px"},on:{"update:visible":function(e){t.is_show_add=e}}},[a("el-form",{attrs:{"label-width":"90px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"类别"}},[a("el-select",{attrs:{filterable:"",placeholder:"输入内容快速检索"},model:{value:t.add_data.type_id,callback:function(e){t.$set(t.add_data,"type_id",e)},expression:"add_data.type_id"}},t._l(t.type_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"行业"}},[a("el-select",{attrs:{filterable:"",placeholder:"输入内容快速检索"},model:{value:t.add_data.industry_id,callback:function(e){t.$set(t.add_data,"industry_id",e)},expression:"add_data.industry_id"}},t._l(t.industry_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"关键字"}},[a("el-input",{attrs:{placeholder:"不同的关键字之见用空格分割"},model:{value:t.add_data.keywords,callback:function(e){t.$set(t.add_data,"keywords",e)},expression:"add_data.keywords"}})],1),a("el-form-item",{attrs:{label:"原文件"}},[a("el-upload",{attrs:{action:t.ServerUrl+"contracts/upload_contract","file-list":t.fileList,"on-success":t.upFileSuccess}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("文件大小不超过8M")])],1)],1),a("el-form-item",{attrs:{label:"缩略图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.ServerUrl+"contracts/upload_contract_pic","show-file-list":!1,"on-success":t.upPicSuccess}},[t.add_data.picture?a("img",{staticClass:"upload-picture",attrs:{src:t.ImgUrl+t.add_data.picture}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"下载价格"}},[a("el-input",{attrs:{placeholder:"单位 元"},model:{value:t.add_data.price,callback:function(e){t.$set(t.add_data,"price",e)},expression:"add_data.price"}},[a("template",{slot:"prepend"},[t._v("￥")])],2)],1),a("el-form-item",{attrs:{label:"已下载次数"}},[a("el-input",{model:{value:t.add_data.downloads,callback:function(e){t.$set(t.add_data,"downloads",e)},expression:"add_data.downloads"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.is_show_add=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitAdd()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.is_show_edit,width:"600px"},on:{"update:visible":function(e){t.is_show_edit=e}}},[a("el-form",{attrs:{"label-width":"90px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"类别"}},[a("el-select",{attrs:{filterable:"",placeholder:"输入内容快速检索"},model:{value:t.edit_data.type_id,callback:function(e){t.$set(t.edit_data,"type_id",e)},expression:"edit_data.type_id"}},t._l(t.type_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"行业"}},[a("el-select",{attrs:{filterable:"",placeholder:"输入内容快速检索"},model:{value:t.edit_data.industry_id,callback:function(e){t.$set(t.edit_data,"industry_id",e)},expression:"edit_data.industry_id"}},t._l(t.industry_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.title,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"关键字"}},[a("el-input",{attrs:{placeholder:"不同的关键字之见用空格分割"},model:{value:t.edit_data.keywords,callback:function(e){t.$set(t.edit_data,"keywords",e)},expression:"edit_data.keywords"}})],1),a("el-form-item",{attrs:{label:"原文件"}},[a("el-upload",{attrs:{action:t.ServerUrl+"contracts/upload_contract","file-list":t.fileList,"on-success":t.upFileSuccessSet}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("文件大小不超过8M")])],1)],1),a("el-form-item",{attrs:{label:"缩略图"}},[a("el-upload",{staticClass:"avatar-uploader",attrs:{action:t.ServerUrl+"contracts/upload_contract_pic","show-file-list":!1,"on-success":t.upPicSuccessSet}},[t.edit_data.picture?a("img",{staticClass:"upload-picture",attrs:{src:t.ImgUrl+t.edit_data.picture}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),a("el-form-item",{attrs:{label:"下载价格"}},[a("el-input",{attrs:{placeholder:"单位 元"},model:{value:t.edit_data.price,callback:function(e){t.$set(t.edit_data,"price",e)},expression:"edit_data.price"}},[a("template",{slot:"prepend"},[t._v("￥")])],2)],1),a("el-form-item",{attrs:{label:"已下载次数"}},[a("el-input",{model:{value:t.edit_data.downloads,callback:function(e){t.$set(t.edit_data,"downloads",e)},expression:"edit_data.downloads"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.is_show_edit=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitEdit()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"图片",visible:t.is_show_pic,width:"600px"},on:{"update:visible":function(e){t.is_show_pic=e}}},[a("img",{staticStyle:{width:"100%"},attrs:{src:t.ImgUrl+t.picture}})])],1)},s=[],l=(a("cadf"),a("551c"),a("097d"),{data:function(){return{is_loading:!1,is_show_add:!1,is_show_edit:!1,is_show_pic:!1,main_input:{keywords:"",type_id:"",industry_id:""},add_data:{picture:"",downloads:0},edit_data:{picture:""},table_height:100,table_data:[],industry_list:[],type_list:[],page:{current_page:1,size:50},fileList:[],picture:""}},created:function(){this.table_height=window.innerHeight-150,this.getInitData(),this.getTableData()},methods:{getInitData:function(){var t=this;this.requestApi({url:"contracts_industries/get",success:function(e){t.industry_list=e}}),this.requestApi({url:"contracts_types/get",success:function(e){t.type_list=e}})},getTableData:function(){var t=this;this.is_loading=!0;var e={page_size:this.page.size,page:this.page.current_page};e.keywords=this.main_input.keywords,e.type_id=this.main_input.type_id,e.industry_id=this.main_input.industry_id,this.requestApi({url:"contracts/get",data:e,success:function(e){t.table_data=e.data,t.page.total=parseInt(e.total),t.is_loading=!1}})},handleCurrentChange:function(t){this.page.current_page=t,this.getTableData()},submitDel:function(t){var e=this;this.$confirm("确定删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.requestApi({url:"contracts/del",data:{id:t.id},success:function(){e.$message.success("删除成功"),e.getTableData()}})}).catch(function(){})},submitAdd:function(){var t=this;this.requestApi({url:"contracts/add",data:this.add_data,success:function(e){t.getTableData(),t.is_show_add=!1,t.$message.success("新增成功")}})},showEditForm:function(t){this.edit_data=JSON.parse(JSON.stringify(t)),this.edit_data.price/=100,this.is_show_edit=!0},submitEdit:function(){var t=this;this.requestApi({url:"contracts/set",data:this.edit_data,success:function(e){t.getTableData(),t.is_show_edit=!1,t.$message.success("编辑成功")}})},upFileSuccess:function(t){1==t.status?this.add_data.file_path=t.data:this.$message.error("服务器错误")},upPicSuccess:function(t){1==t.status?this.add_data.picture=t.data:this.$message.error("服务器错误")},upFileSuccessSet:function(t){1==t.status?this.edit_data.file_path=t.data:this.$message.error("服务器错误")},upPicSuccessSet:function(t){1==t.status?this.edit_data.picture=t.data:this.$message.error("服务器错误")},showPic:function(t){this.picture=t,this.is_show_pic=!0}}}),r=l,n=a("2877"),o=Object(n["a"])(r,i,s,!1,null,null,null);o.options.__file="contracts.vue";e["default"]=o.exports}}]);