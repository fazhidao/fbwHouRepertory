(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3fe925a8"],{d489:function(t,e,a){"use strict";var i=a("f0d1"),n=a.n(i);n.a},f0d1:function(t,e,a){},f91e:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"search_bar"},[a("el-input",{staticClass:"main_input",attrs:{placeholder:"输入名称或手机号搜索",clearable:""},model:{value:t.main_input.text,callback:function(e){t.$set(t.main_input,"text",e)},expression:"main_input.text"}}),a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",clearable:"",placeholder:"省"},on:{change:t.changeProvince},model:{value:t.main_input.province_id,callback:function(e){t.$set(t.main_input,"province_id",e)},expression:"main_input.province_id"}},t._l(t.province_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",clearable:"",placeholder:"市"},on:{change:t.changeCity},model:{value:t.main_input.city_id,callback:function(e){t.$set(t.main_input,"city_id",e)},expression:"main_input.city_id"}},t._l(t.city_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",clearable:"",placeholder:"区"},model:{value:t.main_input.district_id,callback:function(e){t.$set(t.main_input,"district_id",e)},expression:"main_input.district_id"}},t._l(t.district_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-button",{staticStyle:{"margin-right":"10px"},attrs:{type:"primary"},on:{click:function(e){t.getTableData()}}},[t._v("搜 索")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.is_show_add=!0}}},[t._v("新增代理商")]),a("el-breadcrumb",{attrs:{"separator-class":"el-icon-arrow-right"}},[a("el-breadcrumb-item",{attrs:{to:{path:"/index"}}},[t._v("首页")]),a("el-breadcrumb-item",[t._v("用户数据管理")]),a("el-breadcrumb-item",[t._v("代理商管理")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.is_loading,expression:"is_loading"}],staticStyle:{width:"100%"},attrs:{height:t.table_height,data:t.table_data,border:""}},[a("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),a("el-table-column",{attrs:{label:"状态",width:"65"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?a("el-tag",{attrs:{type:"danger"}},[t._v("禁用")]):t._e(),e.row.status>0?a("el-tag",[t._v("正常")]):t._e()]}}])}),a("el-table-column",{attrs:{prop:"balance",label:"代理余额",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[a("div",[t._v("￥"+t._s(t.parseFormatNum(e.row.balance)))]),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showCharge(e.row)}}},[t._v("充值")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showChargeRecors(e.row)}}},[t._v("充值记录")])],1)]}}])}),a("el-table-column",{attrs:{prop:"name",label:"名称"}}),a("el-table-column",{attrs:{prop:"contactor",label:"联系人",width:"100"}}),a("el-table-column",{attrs:{prop:"phone",label:"联系电话",width:"140"}}),a("el-table-column",{attrs:{prop:"corporation",label:"公司法人",width:"80"}}),a("el-table-column",{attrs:{label:"地址"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.province+" "+e.row.city+" "+e.row.district))]),a("div",[t._v(t._s(e.row.address))])]}}])}),a("el-table-column",{attrs:{prop:"note",label:"备注",width:"140"}}),a("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showEditForm(e.row)}}},[t._v("编辑")]),1==e.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){t.submitForbid(e.row)}}},[t._v("禁用")]):t._e(),0==e.row.status?a("el-button",{attrs:{type:"text"},on:{click:function(a){t.submitCancelForbid(e.row)}}},[t._v("启用")]):t._e(),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.showAgencyDetail(e.row.id)}}},[t._v("查看代理情况")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){t.downloadQrcode(e.row)}}},[t._v("下载二维码")])]}}])})],1),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":t.page.current_page,"page-sizes":[50],"page-size":t.page.size,layout:"total,sizes, prev, pager, next, jumper",total:t.page.total},on:{"current-change":t.handleCurrentChange}}),a("el-dialog",{attrs:{title:"新增",visible:t.is_show_add,width:"600px"},on:{"update:visible":function(e){t.is_show_add=e}}},[a("el-form",{attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:t.add_data.name,callback:function(e){t.$set(t.add_data,"name",e)},expression:"add_data.name"}})],1),a("el-form-item",{attrs:{label:"代理余额"}},[a("el-input",{model:{value:t.add_data.balance,callback:function(e){t.$set(t.add_data,"balance",e)},expression:"add_data.balance"}})],1),a("el-form-item",{attrs:{label:"联系人"}},[a("el-input",{model:{value:t.add_data.contactor,callback:function(e){t.$set(t.add_data,"contactor",e)},expression:"add_data.contactor"}})],1),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:t.add_data.phone,callback:function(e){t.$set(t.add_data,"phone",e)},expression:"add_data.phone"}})],1),a("el-form-item",{attrs:{label:"法人"}},[a("el-input",{model:{value:t.add_data.corporation,callback:function(e){t.$set(t.add_data,"corporation",e)},expression:"add_data.corporation"}})],1),a("el-form-item",{attrs:{label:"登录密码"}},[a("el-input",{model:{value:t.add_data.password,callback:function(e){t.$set(t.add_data,"password",e)},expression:"add_data.password"}})],1),a("el-form-item",{attrs:{label:"区域"}},[a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"省"},on:{change:t.changeProvince},model:{value:t.add_data.province_id,callback:function(e){t.$set(t.add_data,"province_id",e)},expression:"add_data.province_id"}},t._l(t.province_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"市"},on:{change:t.changeCity},model:{value:t.add_data.city_id,callback:function(e){t.$set(t.add_data,"city_id",e)},expression:"add_data.city_id"}},t._l(t.city_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"区"},model:{value:t.add_data.district_id,callback:function(e){t.$set(t.add_data,"district_id",e)},expression:"add_data.district_id"}},t._l(t.district_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"具体地址"}},[a("el-input",{model:{value:t.add_data.address,callback:function(e){t.$set(t.add_data,"address",e)},expression:"add_data.address"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:t.add_data.note,callback:function(e){t.$set(t.add_data,"note",e)},expression:"add_data.note"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.is_show_add=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitAdd()}}},[t._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:t.is_show_edit,width:"600px"},on:{"update:visible":function(e){t.is_show_edit=e}}},[a("el-form",{attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{model:{value:t.edit_data.name,callback:function(e){t.$set(t.edit_data,"name",e)},expression:"edit_data.name"}})],1),a("el-form-item",{attrs:{label:"代理余额"}},[a("el-input",{model:{value:t.edit_data.balance,callback:function(e){t.$set(t.edit_data,"balance",e)},expression:"edit_data.balance"}})],1),a("el-form-item",{attrs:{label:"联系人"}},[a("el-input",{model:{value:t.edit_data.contactor,callback:function(e){t.$set(t.edit_data,"contactor",e)},expression:"edit_data.contactor"}})],1),a("el-form-item",{attrs:{label:"联系电话"}},[a("el-input",{model:{value:t.edit_data.phone,callback:function(e){t.$set(t.edit_data,"phone",e)},expression:"edit_data.phone"}})],1),a("el-form-item",{attrs:{label:"法人"}},[a("el-input",{model:{value:t.edit_data.corporation,callback:function(e){t.$set(t.edit_data,"corporation",e)},expression:"edit_data.corporation"}})],1),a("el-form-item",{attrs:{label:"重置密码"}},[a("el-input",{model:{value:t.edit_data.password,callback:function(e){t.$set(t.edit_data,"password",e)},expression:"edit_data.password"}})],1),a("el-form-item",{attrs:{label:"区域"}},[a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"省"},on:{change:t.changeProvince},model:{value:t.edit_data.province_id,callback:function(e){t.$set(t.edit_data,"province_id",e)},expression:"edit_data.province_id"}},t._l(t.province_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px","margin-right":"6px"},attrs:{filterable:"",placeholder:"市"},on:{change:t.changeCity},model:{value:t.edit_data.city_id,callback:function(e){t.$set(t.edit_data,"city_id",e)},expression:"edit_data.city_id"}},t._l(t.city_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1),a("el-select",{staticStyle:{width:"120px"},attrs:{filterable:"",placeholder:"区"},model:{value:t.edit_data.district_id,callback:function(e){t.$set(t.edit_data,"district_id",e)},expression:"edit_data.district_id"}},t._l(t.district_list,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),a("el-form-item",{attrs:{label:"具体地址"}},[a("el-input",{model:{value:t.edit_data.address,callback:function(e){t.$set(t.edit_data,"address",e)},expression:"edit_data.address"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:t.edit_data.note,callback:function(e){t.$set(t.edit_data,"note",e)},expression:"edit_data.note"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.is_show_edit=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitEdit()}}},[t._v("确认编辑")])],1)],1),a("el-dialog",{attrs:{title:"代理商充值",visible:t.is_show_charge,width:"600px"},on:{"update:visible":function(e){t.is_show_charge=e}}},[a("el-form",{attrs:{"label-width":"80px"},nativeOn:{submit:function(t){t.preventDefault()}}},[a("el-form-item",{attrs:{label:"充值对象"}},[a("div",[t._v(t._s(t.charge_info.name))])]),a("el-form-item",{attrs:{label:"充值金额"}},[a("el-input",{model:{value:t.charge_info.charge_amount,callback:function(e){t.$set(t.charge_info,"charge_amount",e)},expression:"charge_info.charge_amount"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{type:"textarea"},model:{value:t.charge_info.note,callback:function(e){t.$set(t.charge_info,"note",e)},expression:"charge_info.note"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.is_show_charge=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){t.submitCharge()}}},[t._v("确认充值")])],1)],1),a("el-dialog",{attrs:{title:"代理商充值",visible:t.is_show_charge_list,width:"800px"},on:{"update:visible":function(e){t.is_show_charge_list=e}}},[a("el-table",{staticStyle:{width:"100%"},attrs:{data:t.charge_list}},[a("el-table-column",{attrs:{type:"index",width:"45",align:"center"}}),a("el-table-column",{attrs:{prop:"charge_amount",label:"充值金额"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v("￥"+t._s(t.parseFormatNum(e.row.charge_amount)))])]}}])}),a("el-table-column",{attrs:{prop:"create_time",label:"充值时间"}}),a("el-table-column",{attrs:{prop:"note",label:"备注"}})],1),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":t.page.charge_page,"page-size":50,layout:"total, prev, pager, next",total:t.page.charge_total},on:{"current-change":t.handleCurrentChange2}})],1),a("vue-qr",{attrs:{id:"qr_code",logoSrc:t.config.logo,text:t.config.href,size:200,margin:0,logoScale:.25,callback:t.qrFinish}})],1)},n=[],l=(a("7f7f"),a("cadf"),a("551c"),a("097d"),a("e289")),s={components:{VueQr:l["a"]},data:function(){return{is_loading:!1,is_show_add:!1,is_show_edit:!1,is_show_charge:!1,is_show_charge_list:!1,main_input:{text:"",province_id:"",city_id:"",district_id:""},add_data:{province_id:"",city_id:"",district_id:""},edit_data:{province_id:"",city_id:"",district_id:""},table_height:100,table_data:[],page:{current_page:1,size:50,total:0,charge_page:1,charge_total:0},province_list:[],city_list:[],district_list:[],charge_info:{},charge_list:[],qr_url:this.WebUrl+"/index.php/api/app/agencyRegister?share=",config:{logo:"/logo.png",href:""}}},created:function(){this.table_height=window.innerHeight-150,this.getTableData(),this.getAreaList(1)},methods:{getTableData:function(){var t=this;this.is_loading=!0;var e={page:this.page.current_page,page_size:this.page.size};""!=this.main_input.text&&(this.main_input.text>1?e.phone=this.main_input.text:e.name=this.main_input.text),""!=this.main_input.province_id&&(e.province_id=this.main_input.province_id),""!=this.main_input.city_id&&(e.city_id=this.main_input.city_id),""!=this.main_input.district_id&&(e.district_id=this.main_input.district_id),this.requestApi({url:"admins/getAgencies",data:e,success:function(e){t.table_data=e.data,t.page.total=parseInt(e.total),t.is_loading=!1}})},getAreaList:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i={area_level:t};a&&(i.parent_id=a),this.requestApi({url:"areainfos/get",data:i,success:function(a){1==t?e.province_list=a:2==t?e.city_list=a:e.district_list=a}})},submitForbid:function(t){var e=this;this.$confirm("确定禁用 "+t.name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.requestApi({url:"admins/forbid",data:{id:t.id},success:function(){e.$message.success("禁用成功"),t.status=0}})}).catch(function(){})},submitCancelForbid:function(t){var e=this;this.$confirm("确定启用 "+t.name+"?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.requestApi({url:"admins/cancelForbid",data:{id:t.id},success:function(){e.$message.success("启用成功"),t.status=2}})}).catch(function(){})},submitAdd:function(){var t=this;this.requestApi({url:"admins/addAgency",data:this.add_data,success:function(e){t.getTableData(),t.is_show_add=!1,t.$message.success("新增成功")}})},showEditForm:function(t){this.getAreaList(2,t.province_id),this.getAreaList(3,t.city_id),this.edit_data=JSON.parse(JSON.stringify(t)),this.edit_data.balance=(this.edit_data.balance/100).toFixed(2),this.is_show_edit=!0},submitEdit:function(){var t=this;this.requestApi({url:"admins/setAgency",data:this.edit_data,success:function(e){t.getTableData(),t.is_show_edit=!1,t.$message.success("编辑成功")}})},changeProvince:function(t){this.add_data.city_id="",this.add_data.district_id="",this.getAreaList(2,t)},changeCity:function(t){this.add_data.district_id="",this.getAreaList(3,t)},handleCurrentChange:function(t){this.page.current_page=t,this.getTableData()},handleCurrentChange2:function(t){this.page.charge_page=t,this.getChargeList()},showAgencyDetail:function(t){this.$router.push("/clients/"+t)},showCharge:function(t){this.charge_info=JSON.parse(JSON.stringify(t)),this.charge_info.note="",this.is_show_charge=!0},submitCharge:function(){var t=this;this.requestApi({url:"agency_charge/add",data:{agency_id:this.charge_info.id,charge_amount:this.charge_info.charge_amount,note:this.charge_info.note},success:function(){t.$message.success("充值成功"),t.is_show_charge=!1,t.getTableData()}})},getChargeList:function(){var t=this;this.requestApi({url:"agency_charge/getList",data:{agency_id:this.charge_info.id,page:this.page.charge_page},success:function(e){t.page.charge_total=e.total,t.charge_list=e.data,t.is_show_charge_list=!0}})},showChargeRecors:function(t){this.charge_info=t,this.getChargeList()},qrFinish:function(t){var e=document.createElement("a");e.download=this.qr_name,e.href=t,e.click()},downloadQrcode:function(t){this.config.href=this.qr_url+t.id,this.qr_name=t.name}}},o=s,r=(a("d489"),a("2877")),c=Object(r["a"])(o,i,n,!1,null,"17d509ce",null);c.options.__file="agencies.vue";e["default"]=c.exports}}]);